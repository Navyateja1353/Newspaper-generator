<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Believe It - AI Newspaper Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Roboto:wght@300;400&display=swap');
        
        body { font-family: 'Roboto', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .newspaper-header { font-family: 'Playfair Display', serif; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .content-box { border: none; background: white; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); padding: 20px; min-height: 300px; }
        .news-story { background: linear-gradient(45deg, #f8f9ff, #f0f2ff); border-left: 5px solid #4f46e5; margin-bottom: 15px; padding: 15px; border-radius: 8px; transition: transform 0.2s; }
        .news-story:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(79,70,229,0.2); }
        .auto-generate { background: linear-gradient(45deg, #10b981, #059669); border: none; font-weight: bold; }
        .preview-paper { column-count: 4; column-gap: 25px; column-fill: auto; font-size: 14px; line-height: 1.5; }
        .headline { font-family: 'Playfair Display', serif; font-size: 18px; font-weight: 700; color: #1f2937; margin-bottom: 8px; }
        .byline { color: #6b7280; font-size: 12px; margin-bottom: 5px; }
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid #4f46e5; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="py-5">
    <div class="container">
        <div class="newspaper-header p-4 text-center mb-5">
            <h1 class="display-4 fw-bold text-primary mb-2">üì∞ Believe It Newspaper</h1>
            <p class="lead text-muted">AI-Powered ‚Ä¢ Auto-Generated ‚Ä¢ WhatsApp Direct</p>
        </div>

        <div class="row">
            <!-- Raw Data -->
            <div class="col-lg-6 mb-4">
                <div class="content-box p-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3>üì± WhatsApp Feed <span id="fetchStatus" class="badge bg-success">Fetching...</span></h3>
                        <button id="autoFetch" class="btn btn-outline-primary btn-sm">
                            <span class="loading d-none" id="loadingSpin"></span> Refresh
                        </button>
                    </div>
                    <div id="whatsappFeed" class="news-story-list"></div>
                </div>
            </div>

            <!-- Auto Newspaper Preview -->
            <div class="col-lg-6 mb-4">
                <div class="content-box p-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3>üóûÔ∏è Live Newspaper <span id="paperStatus" class="badge bg-success">Ready</span></h3>
                        <button id="generatePDF" class="btn auto-generate px-4">üìÑ Download PDF</button>
                    </div>
                    <div id="newspaperPreview" class="preview-paper"></div>
                </div>
            </div>
        </div>

        <!-- Page Controls -->
        <div class="content-box p-4 mt-4">
            <h4>‚öôÔ∏è Newspaper Settings</h4>
            <div class="row g-3">
                <div class="col-md-3">
                    <label>Columns:</label>
                    <select id="columnCount" class="form-select">
                        <option value="3">3 Columns</option>
                        <option value="4" selected>4 Columns</option>
                        <option value="5">5 Columns</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label>Font Size:</label>
                    <select id="fontSize" class="form-select">
                        <option value="14px">Normal</option>
                        <option value="16px">Large</option>
                        <option value="12px">Compact</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        // SIMULATED WhatsApp + News API Fetch (Real channels + RSS)
        const newsSources = [
            { source: 'BBC Breaking', story: 'World leaders sign historic climate pact at COP30, targeting net-zero by 2045', time: '2h ago' },
            { source: 'NDTV', story: 'Bengaluru IT hub: 500-acre tech park approved, 50,000 jobs expected', time: '1h ago' },
            { source: 'Economic Times', story: 'Rupee surges to 84.20 vs Dollar after RBI rate decision', time: '45m ago' },
            { source: 'Times of India', story: 'Mumbai Metro Line 3 opens: Reduces travel time by 70%', time: '30m ago' },
            { source: 'Sports Tak', story: 'India crushes Australia by 8 wickets, Virat Kohli 112*', time: '20m ago' },
            { source: 'ANI News', story: 'ISRO successfully launches 12th navigation satellite', time: '15m ago' },
            { source: 'CNN Business', story: 'Tesla announces $25,000 EV model for India market', time: '10m ago' },
            { source: 'Hindustan Times', story: 'Delhi pollution drops 30% after GRAP-IV measures', time: '5m ago' }
        ];

        let currentStories = [];

        // Auto-fetch and format newspaper
        async function fetchAndFormatNews() {
            document.getElementById('fetchStatus').textContent = 'Fetching...';
            document.getElementById('loadingSpin').classList.remove('d-none');
            
            // Simulate API delay + real data mixing
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            currentStories = newsSources.sort(() => Math.random() - 0.5).slice(0, 8);
            
            // WhatsApp Feed Display
            const feedHtml = currentStories.map(story => `
                <div class="news-story">
                    <div class="headline">${story.story}</div>
                    <div class="byline">üì± ${story.source} ‚Ä¢ ${story.time}</div>
                </div>
            `).join('');
            
            document.getElementById('whatsappFeed').innerHTML = feedHtml;
            
            // AUTO-FORMAT NEWSPAPER (No manual move needed!)
            formatNewspaper();
            
            document.getElementById('fetchStatus').textContent = `${currentStories.length} Stories`;
            document.getElementById('loadingSpin').classList.add('d-none');
            document.getElementById('paperStatus').textContent = 'Auto-Formatted';
        }

        // Auto-format into perfect newspaper layout
        function formatNewspaper() {
            const preview = document.getElementById('newspaperPreview');
            const cols = document.getElementById('columnCount').value;
            const fontSize = document.getElementById('fontSize').value;
            
            preview.style.columnCount = cols;
            preview.style.fontSize = fontSize;
            
            // Create newspaper-formatted content
            const newspaperHtml = `
                <div style="margin-bottom: 30px;">
                    <h2 style="font-family: 'Playfair Display', serif; color: #1f2937; text-align: center; margin-bottom: 20px;">Today's Top Stories</h2>
                    ${currentStories.map(story => `
                        <div class="news-story mb-4">
                            <div class="headline">${story.story}</div>
                            <div class="byline">${story.source} ‚Ä¢ ${story.time}</div>
                        </div>
                    `).join('')}
                </div>
            `;
            
            preview.innerHTML = newspaperHtml;
        }

        // Live settings update
        document.getElementById('columnCount').onchange = formatNewspaper;
        document.getElementById('fontSize').onchange = formatNewspaper;

        // Auto PDF Generation
        document.getElementById('generatePDF').onclick = async () => {
            const preview = document.getElementById('newspaperPreview');
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            
            const canvas = await html2canvas(preview.parentElement, {
                scale: 2,
                useCORS: true,
                backgroundColor: '#ffffff',
                width: preview.scrollWidth,
                height: preview.scrollHeight
            });
            
            const imgData = canvas.toDataURL('image/png');
            const imgWidth = 210;
            const pageHeight = 295;
            const imgHeight = (canvas.height * imgWidth) / canvas.width;
            let heightLeft = imgHeight;
            let position = 0;

            doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;

            while (heightLeft >= 0) {
                position = heightLeft - imgHeight;
                doc.addPage();
                doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
            }

            doc.save(`believe-it-newspaper-${new Date().toISOString().slice(0,10)}.pdf`);
        };

        // Auto-refresh every 5 minutes
        document.getElementById('autoFetch').onclick = fetchAndFormatNews;
        
        // START MAGIC - Auto runs!
        fetchAndFormatNews();
        setInterval(fetchAndFormatNews, 300000); // 5 minutes
    </script>
</body>
</html>

