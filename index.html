<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Believe It Newspaper Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .newspaper-column { column-count: 3; column-gap: 20px; }
        .content-box { border: 1px solid #ccc; padding: 10px; margin: 10px 0; resize: both; overflow: auto; min-height: 200px; }
        .whatsapp-msg { background: linear-gradient(45deg, #e3f2fd, #f3e5f5); border-left: 4px solid #2196f3; margin-bottom: 10px; }
        .demo-mode { background: #fff3cd; border: 1px solid #ffeaa7; }
    </style>
</head>
<body>
    <div class="container-fluid">
        <h1>Believe It Newspaper Generator ðŸš€</h1>
        
        <!-- Status Bar -->
        <div class="alert alert-success demo-mode mb-4">
            <strong>âœ… DEMO MODE ACTIVE</strong> - Real newspaper ready! Click "Move to Preview" â†’ "Generate PDF"
        </div>
        
        <section id="raw-data" class="mb-5">
            <h2>1. Raw Data from WhatsApp Channels <span id="status" class="badge bg-success">Demo Active - 5 Stories</span></h2>
            <div id="rawContent" class="content-box newspaper-column">
                Loading news stories...
            </div>
        </section>
        
        <section id="page-orders" class="mb-5">
            <h2>2. Page Orders</h2>
            <ul id="pageList" class="list-group">
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    Page 1 - Front Page
                    <div>
                        <button class="btn btn-sm btn-primary">â†‘ Up</button>
                        <button class="btn btn-sm btn-secondary">â†“ Down</button>
                        <button class="btn btn-sm btn-danger">Delete</button>
                    </div>
                </li>
            </ul>
            <button id="addPage" class="btn btn-success mt-2">+ Add Page</button>
        </section>
        
        <section id="content-sizing">
            <h2>3. Content Sizing & Preview</h2>
            <div class="row">
                <div class="col-md-3">
                    <label>Page Size:</label>
                    <select id="pageSize" class="form-select">
                        <option>A4</option>
                        <option>Tabloid</option>
                        <option>Broadsheet</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label>Columns:</label>
                    <input type="number" id="columns" min="1" max="5" value="3" class="form-control">
                </div>
                <div class="col-md-3">
                    <button id="moveToPreview" class="btn btn-info mt-3">â†’ Move All to Preview</button>
                </div>
                <div class="col-md-3">
                    <button id="generatePDF" class="btn btn-success mt-3 w-100">ðŸ“„ Generate PDF</button>
                </div>
            </div>
            <div id="preview" class="content-box mt-3 newspaper-column p-4 bg-white">
                Preview your newspaper here...
            </div>
        </section>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        // DEMO NEWS DATA - Real looking WhatsApp channels
        const demoNews = [
            { senderData: { chatId: 'BBC-News' }, messageData: { textMessageData: { textMessage: 'BREAKING: World leaders agree on new climate targets at COP30 summit in Brazil' }, timestamp: Math.floor(Date.now()/1000) - 3600 } },
            { senderData: { chatId: 'CNN-Breaking' }, messageData: { textMessageData: { textMessage: 'Tech stocks surge 8% as AI chip breakthrough announced by NVIDIA' }, timestamp: Math.floor(Date.now()/1000) - 1800 } },
            { senderData: { chatId: 'TimesofIndia' }, messageData: { textMessageData: { textMessage: 'Bengaluru: Heavy rains cause flooding on Outer Ring Road, traffic diverted' }, timestamp: Math.floor(Date.now()/1000) - 900 } },
            { senderData: { chatId: 'EconomicTimes' }, messageData: { textMessageData: { textMessage: 'Rupee hits 85.50 vs Dollar as RBI intervenes in forex market' }, timestamp: Math.floor(Date.now()/1000) - 720 } },
            { senderData: { chatId: 'SportsStar' }, messageData: { textMessageData: { textMessage: 'India beats Australia by 6 wickets in 2nd T20I, Rohit Sharma 92* unbeaten' }, timestamp: Math.floor(Date.now()/1000) - 300 } }
        ];

        // Load Demo Data (Auto-runs on page load)
        async function loadRawData() {
            const rawContent = document.getElementById('rawContent');
            rawContent.innerHTML = demoNews.map((msg, index) => 
                `<div class="whatsapp-msg p-3 mb-3 border rounded shadow-sm" draggable="true" ondragstart="drag(event, ${index})">
                    <strong>ðŸ“± ${msg.senderData.chatId}</strong>
                    <br><small class="text-muted">ðŸ•’ ${new Date(msg.messageData.timestamp * 1000).toLocaleString('en-IN')}</small>
                    <br><strong>${msg.messageData.textMessageData.textMessage}</strong>
                </div>`
            ).join('');
            
            document.getElementById('status').textContent = 'Demo Active - 5 Stories Ready';
            document.getElementById('status').className = 'badge bg-success';
        }

        // Page Orders
        document.getElementById('addPage').onclick = () => {
            const li = document.createElement('li');
            li.className = 'list-group-item d-flex justify-content-between align-items-center';
            li.innerHTML = `Page ${document.querySelectorAll('#pageList li').length + 1} 
                <div>
                    <button class="btn btn-sm btn-primary">â†‘ Up</button>
                    <button class="btn btn-sm btn-secondary">â†“ Down</button>
                    <button class="btn btn-sm btn-danger">Delete</button>
                </div>`;
            document.getElementById('pageList').appendChild(li);
        };

        // Columns Preview
        document.getElementById('columns').onchange = () => {
            const cols = document.getElementById('columns').value;
            document.getElementById('preview').style.columnCount = cols;
        };

        // Move All to Preview
        document.getElementById('moveToPreview').onclick = () => {
            const rawItems = document.querySelectorAll('#rawContent .whatsapp-msg');
            const preview = document.getElementById('preview');
            preview.innerHTML = ''; // Clear preview
            rawItems.forEach(item => {
                preview.appendChild(item.cloneNode(true));
            });
            alert('âœ… All stories moved to preview! Now generate PDF!');
        };

        // Drag & Drop
        function drag(ev, index) {
            ev.dataTransfer.setData("text", index);
        }

        // PDF Generation
        document.getElementById('generatePDF').onclick = async () => {
            const preview = document.getElementById('preview');
            
            if (preview.innerHTML.trim() === 'Preview your newspaper here...' || preview.children.length === 0) {
                alert('âš ï¸ Move stories to Preview first using "â†’ Move All to Preview" button!');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            
            try {
                const canvas = await html2canvas(preview, {
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    backgroundColor: '#ffffff'
                });
                
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = 210;
                const pageHeight = 295;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;

                doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;

                while (heightLeft >= 0) {
                    position = heightLeft - imgHeight;
                    doc.addPage();
                    doc.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                }

                doc.save('believe-it-newspaper.pdf');
                alert('ðŸŽ‰ Newspaper PDF downloaded! Check your Downloads folder.');
            } catch(e) {
                doc.html(preview, {
                    callback: function(doc) { doc.save('believe-it-newspaper.pdf'); },
                    x: 10, y: 10, width: 190, windowWidth: 800
                });
            }
        };

        // START APP - Load demo data immediately
        loadRawData();
    </script>
</body>
</html>

               

